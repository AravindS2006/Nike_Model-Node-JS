<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nike Clone (Enhanced)</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
       /* Updated Reset & General Styles */
        body, h1, h2, h3, p, ul, li, a, button, input, textarea {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body { font-family: 'Roboto', sans-serif; line-height: 1.6; background-color: #f9f9f9; color: #333; }
        .container { width: 90%; max-width: 1200px; margin: 20px auto; padding: 20px; background-color: #fff; border-radius: 12px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08); }
        header { background-color: #111; color: #fff; padding: 20px 0; }
        nav { display: flex; justify-content: space-between; align-items: center; width: 90%; max-width: 1200px; margin: 0 auto; }
        nav a { color: #fff; text-decoration: none; margin: 0 15px; font-weight: 500; transition: color 0.3s; }
        nav a:hover { color: #ddd; }
         nav .logo { font-size: 1.75rem; font-weight: 700; letter-spacing: 1px;}
        .notification {
            background-color: #4caf50; color: white; padding: 10px;
            text-align: center; position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
            border-radius: 4px; z-index: 1000; display:none;
        }
        .notification.active { display:block;}
           .error-message {
        color: #e74c3c;
        margin-top: 5px;
         display:block;
      }
        /* Form Styles (Improved) */
        form {
            display: flex; flex-direction: column; margin-top: 20px;
        }
         form .form-group{ display:flex; flex-direction: column; margin-bottom: 15px;}

        form label { margin-bottom: 7px; font-weight: 500; }
        form input, form textarea, form select {
            padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 6px; font-size: 1em;
            transition: border-color 0.3s; }
        form input:focus, form textarea:focus, form select:focus{ border-color: #555; outline: none}
         form button {
            padding: 12px 20px; background-color: #111; color: #fff; border: none; border-radius: 6px;
            cursor: pointer; font-size: 1em; transition: background-color 0.3s; }
        form button:hover { background-color: #333; }
        /* Products Layout (Enhanced) */
        .products { display: flex; flex-wrap: wrap; justify-content: space-around; }
        .product-card {
            border: 1px solid #eee; padding: 15px; margin: 15px; width: calc(33.33% - 30px); /* Responsive cards */
            text-align: center; border-radius: 10px; background-color: #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
          @media (max-width: 768px) {
          .product-card {
              width: calc(50% - 30px);
            }
        }
          @media (max-width: 480px) {
          .product-card {
              width: calc(100% - 30px);
            }
        }
        .product-card:hover { transform: translateY(-5px); }
        .product-card img { max-width: 100%; height: auto; margin-bottom: 15px; border-radius: 8px; }
        .product-card h3 { margin-bottom: 10px; font-size: 1.2em;}
        .product-card p { margin-bottom: 12px;}
        .product-card button {
            background-color: #111; color: #fff; border: none; padding: 10px 20px; cursor: pointer;
            border-radius: 6px; transition: background-color 0.3s; }
        .product-card button:hover { background-color: #333; }
        .product-details { margin-top: 20px; padding: 15px; background: #fff; border-radius: 10px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);}
        .product-details img { max-width: 400px; margin: 0 auto 15px; display: block; border-radius: 8px; }
        .product-details h2 { margin-bottom: 12px; font-size: 1.5em; }
        .product-details p { margin-bottom: 15px; line-height: 1.7; }
        .cart-items { list-style: none; padding: 0; }
        .cart-items li { margin-bottom: 12px; border-bottom: 1px solid #eee; padding-bottom: 12px; display: flex; align-items: center; justify-content: space-between; }
        .cart-items li:last-child { border-bottom: none; }
        .cart-items span { font-weight: 500; }
        .cart-items input { width: 50px; padding: 6px; border: 1px solid #ddd; border-radius: 4px; margin: 0 5px;}
         .cart-items button {
             background-color: #e74c3c; color: #fff; border: none; padding: 8px 12px; cursor: pointer;
             border-radius: 4px; transition: background-color 0.3s; }
         .cart-items button:hover { background-color: #c0392b; }
        #checkout-form label { display: block; margin-bottom: 7px; }
        #checkout-form input { width: 100%; padding: 10px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 6px; }
        #checkout-form button { background-color: #111; color: #fff; padding: 12px 20px; border: none; border-radius: 6px; cursor: pointer; }
    </style>

</head>
<body>
    <header>
        <nav>
            <div class="logo">Nike (Enhanced)</div>
            <div>
                <a href="/" id="home-link">Home</a>
                <a href="/products" id="products-link">Products</a>
                <a href="/cart" id="cart-link">Cart</a>
                  <a href="/profile" id="profile-link">Profile</a>
                <a href="/login" id="login-link">Login</a>
            </div>
        </nav>
    </header>
    <div class="notification" id="notification-area"></div>
    <div class="container" id="page-content">
      <!-- Page-specific content will load here-->
        <div id="content-area"></div>
    </div>
    <script>
         const API_BASE_URL = "http://localhost:5000"; // Adjust as needed

        // Define route handlers in a single file for demonstration
        const routes = {
            "/": displayHomePage,
            "/products": displayProductsPage,
            "/product/:id": displayProductDetailsPage,
            "/cart": displayShoppingCartPage,
            "/checkout": displayCheckoutPage,
            "/login": displayLoginPage,
            "/register": displayRegisterPage,
             "/profile": displayProfilePage,
        };

         // Fake cart and user data. No persistence!
        let cart = [];
        let user = null;

          function showNotification(message, duration = 3000){
              const notificationArea = document.getElementById("notification-area");
              notificationArea.textContent = message;
              notificationArea.classList.add('active');

              setTimeout(() => {
                notificationArea.classList.remove('active');
              }, duration);

          }
        // Generic function to handle page loading (for demo, NO actual AJAX)
        function loadPage() {
            const path = window.location.pathname;
            let matchedRoute = routes[path]; // Get the function directly

            if (!matchedRoute){
                // Check for dynamic route for products
                if(path.startsWith("/product/")){
                    const id = path.split("/")[2]; // Get product id from url
                    matchedRoute = () => displayProductDetailsPage(id); // Function will call display with id
                }
            }

            if(matchedRoute) {
                const contentArea = document.getElementById('content-area');
                if(contentArea) {
                     contentArea.innerHTML = "";
                    matchedRoute();
                }
            } else {
                 document.getElementById("content-area").innerHTML = `
                 <h1>404 Not Found</h1>
                 <p>The page you requested was not found.</p>
                 `;
            }
        }

        function changePage(path){
          window.history.pushState({},'', path);
          loadPage();
        }

        // Add event listeners to navigation links to trigger dynamic route changes

        document.getElementById('home-link').addEventListener('click', (event) => {
            event.preventDefault();
             changePage("/");
        });

        document.getElementById('products-link').addEventListener('click', (event) => {
            event.preventDefault();
            changePage("/products");
        });
        document.getElementById('cart-link').addEventListener('click', (event) => {
            event.preventDefault();
            changePage("/cart");
        });

          document.getElementById('profile-link').addEventListener('click', (event) => {
              event.preventDefault();
              if(user){
                changePage("/profile");
              } else {
                   changePage('/login')
              }
        });

        document.getElementById('login-link').addEventListener('click', (event) => {
            event.preventDefault();
            changePage("/login");
        });


       //Function to add product to the cart (no real storage)
        function addToCart(productId) {
              let newProduct = {id: productId, name: 'Product ' + productId, price: Math.random() * 100 + 20, qty:1}
                let existingItem = cart.find(item => item.id === productId);
              if(existingItem){
                existingItem.qty++;
              } else {
                cart.push(newProduct)
              }
                showNotification("Added " + newProduct.name + " to cart!");
        }


       function removeFromCart(productId){
           cart = cart.filter(item => item.id !== productId)
           displayShoppingCartPage();
       }


    function updateQuantity(productId, qty){
            const product = cart.find(item => item.id == productId);
            if(product){
                product.qty = parseInt(qty, 10);
            }

            displayShoppingCartPage();
        }

       // Route handlers for pages, will load HTML into the content-area
        function displayHomePage() {
          document.getElementById("content-area").innerHTML = `
            <section>
                <h2>Welcome to Nike (Enhanced)</h2>
                <p>Explore our latest collection of sports apparel and footwear.</p>
                 <p><em>Note: This is a demo. No real persistence!</em></p>
                <img src="https://placehold.co/600x250" alt="Banner Image"/>
            </section>
          `;
        }

        function displayProductsPage() {
           document.getElementById("content-area").innerHTML = `
            <h2>Our Products</h2>
            <div class="products">
                <div class="product-card">
                  <img src="https://placehold.co/300x200/007bff/ffffff" alt="Shoe 1">
                  <h3>Running Shoe</h3>
                  <p>$100.00</p>
                  <button onclick="addToCart(1)">Add to Cart</button>
                  <a style="display:block; text-decoration: underline; margin-top: 5px;" onclick="changePage('/product/1')">View Details</a>
                </div>
                <div class="product-card">
                  <img src="https://placehold.co/300x200/28a745/ffffff" alt="Shoe 2">
                  <h3>Basketball Shoe</h3>
                  <p>$120.00</p>
                   <button onclick="addToCart(2)">Add to Cart</button>
                    <a style="display:block; text-decoration: underline; margin-top: 5px;"  onclick="changePage('/product/2')">View Details</a>
                </div>
                <div class="product-card">
                  <img src="https://placehold.co/300x200/dc3545/ffffff" alt="Shoe 3">
                  <h3>Training Shoe</h3>
                  <p>$150.00</p>
                    <button onclick="addToCart(3)">Add to Cart</button>
                      <a style="display:block; text-decoration: underline; margin-top: 5px;"  onclick="changePage('/product/3')">View Details</a>
                </div>
                <div class="product-card">
                  <img src="https://placehold.co/300x200/ffc107/ffffff" alt="Apparel 1">
                  <h3>Running Shirt</h3>
                  <p>$60.00</p>
                    <button onclick="addToCart(4)">Add to Cart</button>
                      <a style="display:block; text-decoration: underline; margin-top: 5px;"  onclick="changePage('/product/4')">View Details</a>
                 </div>
                  <div class="product-card">
                  <img src="https://placehold.co/300x200/17a2b8/ffffff" alt="Apparel 2">
                  <h3>Training Shorts</h3>
                  <p>$40.00</p>
                    <button onclick="addToCart(5)">Add to Cart</button>
                      <a style="display:block; text-decoration: underline; margin-top: 5px;"  onclick="changePage('/product/5')">View Details</a>
                 </div>

            </div>
          `;
        }

        function displayProductDetailsPage(productId) {
           document.getElementById("content-area").innerHTML = `
            <div class="product-details">
                <h2>Product Details</h2>
                 <img src="https://placehold.co/400x300" alt="Product Image">
                <h2>Product ${productId}</h2>
                <p>This is the detailed description of product with ID ${productId}.  This can include sizes, materials etc. For demo purposes, just a placeholder.</p>
                 <p><b>Price: $${(Math.random() * 100 + 20).toFixed(2)}</b></p>
                <button onclick="addToCart(${productId})">Add to Cart</button>
                <br><br><button onclick="changePage('/products')">Back to Products</button>
            </div>
          `;
        }

        function displayShoppingCartPage() {
            let cartItemsHtml = "";
            let total = 0;
            if (cart.length > 0) {
                cart.forEach(item => {
                    const subtotal = item.price * item.qty;
                    total += subtotal;

                    cartItemsHtml += `
                    <li>
                        <span>${item.name}</span>
                        <span>$${item.price.toFixed(2)}</span>
                        <input type="number" value="${item.qty}" min="1" onchange="updateQuantity(${item.id}, this.value)"/>
                         <span>Subtotal: $${subtotal.toFixed(2)}</span>
                        <button onclick="removeFromCart(${item.id})">Remove</button>

                    </li>
                `;
                });

                cartItemsHtml += `<p><b>Total: $${total.toFixed(2)}</b></p>`

                cartItemsHtml += `<button onclick="changePage('/checkout')">Proceed to Checkout</button>`
            } else {
                cartItemsHtml = "<p>Your cart is empty.</p>";
            }
         document.getElementById("content-area").innerHTML = `
            <h2>Shopping Cart</h2>
            <ul class="cart-items">
               ${cartItemsHtml}
            </ul>
              <br><br><button onclick="changePage('/products')">Continue Shopping</button>
        `;
        }

          function displayProfilePage(){
               if(user){
                    document.getElementById("content-area").innerHTML = `
                         <h2>User Profile</h2>
                         <p><b>Username:</b> ${user.username}</p>
                           <p><b>Email:</b> ${user.email || 'Not provided'}</p>
                           <br><button onclick="changePage('/')">Back To Home</button>
                         `;
                } else {
                      document.getElementById("content-area").innerHTML = `
                           <h2>Not logged in</h2>
                          <button onclick="changePage('/login')">Login</button>
                          `
                }
          }

        function displayCheckoutPage() {
           document.getElementById("content-area").innerHTML = `
            <h2>Checkout</h2>
            <form id="checkout-form">
               <div class="form-group">
                 <label for="name">Name:</label>
                <input type="text" id="name" required>
               </div>
               <div class="form-group">
                 <label for="email">Email:</label>
                 <input type="email" id="email" required>
               </div>
               <div class="form-group">
                 <label for="address">Address:</label>
                <textarea id="address" required></textarea>
              </div>
                <button onclick="submitCheckout()">Place Order</button>
            </form>
              <br><br><button onclick="changePage('/cart')">Back to Cart</button>
          `;
        }

         function displayLoginPage() {
            document.getElementById("content-area").innerHTML = `
                <h2>Login</h2>
                <form id="login-form">
                  <div class="form-group">
                      <label for="username">Username:</label>
                      <input type="text" id="username" required>
                         <span id="username-error" class="error-message"></span>
                  </div>
                    <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" required>
                    <span id="password-error" class="error-message"></span>
                    </div>
                    <button type="button" onclick="submitLogin()">Login</button>
                </form>
                   <br>
                <button onclick="changePage('/register')">Register</button>
            `;
        }

        function displayRegisterPage() {
            document.getElementById("content-area").innerHTML = `
                <h2>Register</h2>
                <form id="register-form">
                <div class="form-group">
                    <label for="new-username">Username:</label>
                    <input type="text" id="new-username" required>
                    <span id="new-username-error" class="error-message"></span>
                 </div>
                <div class="form-group">
                   <label for="new-password">Password:</label>
                   <input type="password" id="new-password" required>
                    <span id="new-password-error" class="error-message"></span>
                </div>
                 <div class="form-group">
                   <label for="email">Email:</label>
                  <input type="email" id="email" required>
                     <span id="email-error" class="error-message"></span>
                </div>

                <button type="button" onclick="submitRegister()">Register</button>
                </form>
                <br>
                <button onclick="changePage('/login')">Back to Login</button>
            `;
        }


    // Simulated form submissions
    function submitCheckout(){
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const address = document.getElementById('address').value;

         showNotification(`Checkout Completed!`);
        cart = [];
        changePage('/')
    }


      async function submitLogin() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
             const usernameError = document.getElementById("username-error");
            const passwordError = document.getElementById("password-error");
             usernameError.textContent = "";
             passwordError.textContent = "";
            try{
               const response = await fetch(`${API_BASE_URL}/login`, {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json",
                    },
                    body: JSON.stringify({username, password}),
                });
                const data = await response.json();
                if(response.ok) {
                     user = {username};
                     showNotification("Login Successful!");
                    changePage('/');

                } else {
                    if(data && data.message){
                        usernameError.textContent = data.message;
                        passwordError.textContent = data.message;
                    }
                    console.log("Error login ", data);
                }
            } catch(err){
                console.log("Error during login", err);
            }
        }

       async function submitRegister() {
            const newUsername = document.getElementById('new-username').value;
            const newPassword = document.getElementById('new-password').value;
            const email = document.getElementById('email').value;

             const usernameError = document.getElementById("new-username-error");
             const passwordError = document.getElementById("new-password-error");
              const emailError = document.getElementById("email-error");

            usernameError.textContent = "";
            passwordError.textContent ="";
             emailError.textContent = "";


            try{
                  const response = await fetch(`${API_BASE_URL}/register`, {
                        method: "POST",
                        headers: {
                        "Content-Type": "application/json",
                        },
                        body: JSON.stringify({username: newUsername, password: newPassword, email}),
                    });

                     const data = await response.json();

                     if(response.ok) {
                       user = {username: newUsername, email};
                       showNotification("Registration Successful!");
                         changePage('/');
                     } else {
                        if(data && data.message){
                            usernameError.textContent = data.message;
                            passwordError.textContent = data.message;
                             emailError.textContent = data.message;
                        }
                        console.log("Error registering ", data);
                     }
            } catch(err) {
                console.log("Error during registration", err);
            }
        }

    // Initial page load
    window.addEventListener('load', () => loadPage());
    window.addEventListener("popstate", loadPage);

     </script>
</body>
</html>